# 智慧校园态势感知中心

## 项目概述

智慧校园态势感知中心是一个基于Web的实时数据可视化平台，通过图表和地图界面展示校园内各区域的实时状态信息。该项目实现了校园内人流量监测、区域分布统计、环境数据监控等功能，为校园管理者提供直观的决策支持。

## 技术栈

- **前端框架**: ECharts 5.4.3 (数据可视化)
- **前端语言**: HTML5, CSS3, JavaScript (ES6+)
- **响应式布局**: Flexbox 布局
- **主题切换**: CSS Variables + JavaScript
- **数据可视化**: ECharts 图表库 (折线图、饼图、雷达图、柱状图、仪表盘、热力图等)
- **字体**: SmileySans-Oblique.otf
- **图片资源**: 校园背景图和logo图片

## 功能特性

### 1. 实时数据展示
- 人流量趋势监测 (折线图)
- 区域热力分布占比 (饼图)
- 入校权限分析 (雷达图)
- 实时拥挤指数 (仪表盘)
- 环境舒适度监控 (柱状图)
- 人群结构画像 (柱状图)

### 2. 校园地图可视化
- 校园关键地点可视化展示 (知津楼、格致楼、图书馆、食堂等)
- 动态连接线显示各区域关系
- 交互式点击选中功能

### 3. 主题切换功能
- 昼夜模式自动切换 (基于时间自动判断)
- 手动主题切换功能
- 完整的CSS变量系统支持主题切换

### 4. 数据概览面板
- 全校在校总人数统计
- 全校男女比例显示

### 5. 字体系统
- **SmileySans字体**: 项目中使用了独特的SmileySans-Oblique.otf字体，为界面提供个性化的视觉体验
- **字体加载**: 通过CSS @font-face规则加载本地字体文件
- **字体回退**: 提供了适当的字体回退机制（PingFang SC, Microsoft YaHei等）
- **字体大小调整**: 对全局字体和仪表板特定元素进行了大小调整，以提供更好的可读性

### 6. 图片资源系统
- **Logo图片**: 页面顶部显示智慧校园logo图片，具有明暗模式自适应效果
- **校园背景图**: 地图区域使用校园平面图作为背景，帮助用户直观识别各个区域位置
- **图片优化**: 使用CSS实现图片透明度和比例适配，确保在不同屏幕尺寸下正常显示

### 7. 字体大小优化
- **全局字体放大**: 通过CSS设置，将全局字体大小增加了10%，提升整体可读性
- **仪表板字体调整**: 针对仪表板容器内的特定元素（卡片标题、数据标签、数据值、节点按钮等）进行了专门的字体大小优化
- **精确计算**: 卡片标题从14px增加到15.4px，数据值从28px增加到30.8px，节点按钮从13px增加到14.3px等
- **用户体验**: 字体放大后，用户在查看数据时更加舒适，特别是在大屏幕显示场景下

## 核心技术点

### 1. CSS Variables 主题系统
使用CSS变量实现主题切换，定义了完整的暗色和亮色主题变量：
``css
:root {
  --bg-color: #0b1120; /* 暗色背景 */
  --panel-bg: rgba(30, 41, 59, 0.4); /* 面板背景 */
  --text-primary: #e2e8f0; /* 主要文字颜色 */
}

body.theme-light {
  --bg-color: #f8fafc; /* 亮色背景 */
  --panel-bg: rgba(255, 255, 255, 0.75); /* 亮色面板背景 */
}
```

### 2. ECharts 主题适配
动态生成图表主题配置，确保图表在不同主题下正确显示：
``javascript
function getChartTheme() {
  if (isLightMode) {
    return {
      textStyle: { color: '#64748b' }, // 亮色模式文字
      title: { textStyle: { color: '#1e293b' } },
      // ...
    };
  } else {
    return {
      textStyle: { color: '#94a3b8' }, // 暗色模式文字
      title: { textStyle: { color: '#e2e8f0' } },
      // ...
    };
  }
}
```

### 3. 动态SVG连接线
使用SVG路径绘制连接校园各区域的动态连线：
``javascript
function drawConnections() {
  const stage = document.getElementById('mapStage');
  const pathEl = document.getElementById('dynamic-connection');
  // ...
  pathD += "Z";
  pathEl.setAttribute('d', pathD);
}
```

### 4. 响应式设计
使用Flexbox布局实现响应式界面，适配不同屏幕尺寸：
- 三列布局 (左右侧栏 + 中央地图)
- 响应式图表尺寸
- 窗口大小变化监听与重绘

### 5. Mock数据系统
完整的模拟数据结构，包含各区域的详细信息：
``javascript
const mockData = {
  'library': { name: '博文馆 (图书馆)', value: 85, structure: [120, 15, 5, 2], env: [45, 24], type: 'lib' },
  // ...
};
```

## 框架结构详解

### CSS框架结构

项目采用模块化的CSS架构，主要分为以下几个部分：

#### 1. 主题变量定义
- **暗色主题**: 使用深蓝、深灰等颜色，适合夜间使用
- **亮色主题**: 使用白色、浅灰等颜色，适合白天使用
- **颜色变量**: 定义了状态色（绿、蓝、黄、红），用于不同数据状态的表示
- **组件变量**: 定义了面板、边框、文字等组件的颜色

#### 2. 布局结构
- **三列布局**: 使用Flexbox实现左右侧栏和中央内容区域
- **响应式设计**: 根据屏幕尺寸自适应调整布局
- **间距系统**: 统一的内外边距设计

#### 3. 组件样式
- **卡片容器**: 用于图表展示，具有圆角、阴影和背景模糊效果
- **概览面板**: 显示全校关键数据，使用大字体突出显示
- **地图区域**: 带网格背景的可视化地图，支持动态连接线
- **节点按钮**: 表示校园各区域，具有悬停和激活状态
- **信息栏**: 显示当前选中区域的详细信息

#### 4. 交互效果
- **主题切换过渡**: 使用CSS transition实现平滑的主题切换
- **动画效果**: 包括连接线流动动画、按钮悬停效果等
- **状态指示**: 通过颜色和样式变化反映不同状态

### 图表框架结构

项目使用ECharts作为数据可视化引擎，包含以下图表类型：

#### 1. 人流量趋势图 (折线图)
- **类型**: 折线图 (line)
- **数据**: 时间序列数据（8:00, 10:00, 12:00, 14:00, 16:00）
- **特点**: 平滑曲线、面积填充、坐标轴提示
- **用途**: 展示一天中人流量的变化趋势

#### 2. 区域热力分布图 (饼图)
- **类型**: 环形饼图 (pie)
- **数据**: 教学区、生活区、图书区的占比
- **特点**: 环形设计、圆角边框、颜色区分
- **用途**: 显示各区域的相对占比关系

#### 3. 入校权限分析图 (雷达图)
- **类型**: 雷达图 (radar)
- **指标**: 门禁卡、访客、车辆、人脸、其他
- **特点**: 填充区域、多维度对比
- **用途**: 分析入校权限的多样性

#### 4. 实时拥挤指数 (仪表盘)
- **类型**: 仪表盘 (gauge)
- **数据**: 拥挤度百分比 (0-100%)
- **特点**: 进度显示、颜色编码（绿<40，蓝<60，黄<80，红≥80）
- **用途**: 直观显示当前拥挤程度

#### 5. 人群结构画像 (柱状图)
- **类型**: 柱状图 (bar)
- **数据**: 学生、教职工、后勤、访客的百分比
- **特点**: 彩色柱条、百分比标签、圆角设计
- **用途**: 显示人员构成比例

#### 6. 环境舒适度 (横向柱状图)
- **类型**: 横向柱状图 (bar)
- **数据**: 湿度和温度的实时值
- **特点**: 颜色编码（根据数值范围变化）、横向布局
- **用途**: 监控环境参数的舒适度

## 重难点分析

### 1. 主题切换的复杂性
**难点**: 确保ECharts图表在主题切换后正确显示不同颜色，包括坐标轴、文字、网格线等元素。
**解决方案**: 
- 创建动态主题配置函数
- 在主题切换时重新初始化所有图表实例
- 使用CSS变量系统统一管理颜色

### 2. SVG动态路径绘制
**难点**: 动态计算各区域按钮位置并绘制连接线，需要处理窗口大小变化。
**解决方案**:
- 使用`getBoundingClientRect()`获取元素绝对位置
- 实现resize事件监听器，自动重绘连接线

### 3. 多图表协同更新
**难点**: 点击地图区域后，需要同时更新多个图表的数据和状态。
**解决方案**:
- 统一的数据管理机制
- 中心化的`handleSelect`函数处理状态变更
- 模块化的图表更新函数

### 4. 数据可视化设计
**难点**: 不同类型的数据需要使用不同的图表类型进行展示，同时保持视觉一致性。
**解决方案**:
- 选择合适的图表类型对应数据特征
- 统一的颜色方案和交互逻辑
- 自适应的坐标轴和标签配置

### 5. 性能优化考虑
**难点**: 多个ECharts实例同时渲染可能影响性能。
**解决方案**:
- 图表实例的复用机制
- 仅在必要时重绘图表
- 适当的动画和过渡效果

## 项目结构

```
SchoolLifeBigBoard/
├── css/
│   └── common.css          # 样式文件，包含主题系统和字体定义
├── font/                   # 字体文件目录
│   └── SmileySans-Oblique.otf # SmileySans字体文件
├── images/                 # 图片资源目录
│   ├── logo1.png          # 顶部导航栏logo图片
│   ├── image4.png         # 校园背景图
│   └── ...                # 其他图片资源
├── js/
│   └── common.js           # JavaScript逻辑，包含图表初始化和交互
├── index.html              # 主页面文件
└── README.md               # 项目说明文档
```

## 扩展性考虑

1. **数据源扩展**: 当前使用Mock数据，可替换为真实API数据源
2. **图表扩展**: 支持添加更多类型的图表和数据展示
3. **功能扩展**: 可增加告警、数据分析、历史趋势等功能模块
4. **移动端适配**: 可进一步优化移动端体验

## 使用说明

1. 直接在浏览器中打开[index.html](file:///f:%5C%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A%5Cecharts%5C%E6%96%B0%E5%BB%BA%E6%96%87%E4%BB%B6%E5%A4%B9%20(6)%5CSchoolLifeBigBoard/index.html)文件即可使用
2. 点击顶部"切换主题"按钮可手动切换昼夜模式
3. 点击地图上的区域按钮可查看该区域的详细数据
4. 系统会根据当前时间自动调整主题模式（6:00-18:00为亮色模式，其他时间为暗色模式）

## 总结

本项目展示了现代Web数据可视化的核心技术，包括响应式设计、主题切换、图表集成、交互设计等。通过CSS Variables和JavaScript的结合，实现了灵活的主题系统；通过ECharts的强大功能，实现了丰富的数据可视化效果。项目具有良好的扩展性，可作为校园管理系统或其他数据监控平台的基础。